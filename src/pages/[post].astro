---
import EmailWidget from "../components/EmailWidget.astro";
import RecentPosts from "../components/RecentPosts.astro";
import Page from "../layouts/Page.astro";
import getPost from "../utils/getPost";
import sanitize from "../utils/sanitize";

const slug = Astro.params.post || "";
const post = await getPost(slug);

if (!post) {
  return Astro.response(404, "Not Found");
}

const { title, content, date, recentPosts } = post;
---

<Page date={date} title={sanitize(title)}>
  <RecentPosts slot="aside" posts={recentPosts} />
  <EmailWidget slot="aside" />
  <div class="post-content" set:html={content} />
</Page>

<style is:global>
  .post-content * + * {
    @apply mt-6;
  }

  .iframe-video {
    margin-top: 2rem;
    margin-bottom: 2rem;
    position: relative;
    padding-bottom: 56.25%;
    padding-top: 30px;
    height: 0;
    overflow: hidden;
  }

  iframe {
    width: 100%;
    height: auto;
    aspect-ratio: 16/9;
  }
</style>
