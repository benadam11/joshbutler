---
import EmailWidget from "../components/EmailWidget.astro";
import PostLinks from "../components/PostLinks.astro";
import TableOfContents from "../components/TableOfContents.astro";
import Page from "../layouts/Page.astro";
import { getPosts } from "../utils/getPosts";
import { books } from "./books.astro";
import { getRuntime } from "@astrojs/cloudflare/runtime";

const postData = await getPosts(getRuntime(Astro.request));
const posts = postData?.posts || [];
---

<Page title="Blog">
  <TableOfContents slot="aside" links={books} title="Books" />
  <EmailWidget slot="aside" />
  <PostLinks posts={posts} />
</Page>
